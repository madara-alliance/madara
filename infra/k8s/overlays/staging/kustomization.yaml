apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: staging

bases:
  - ../../base

namePrefix: staging-

nameSuffix: ""

replicas:
  - name: orchestrator
    count: 2

images:
  - name: ghcr.io/madara-alliance/orchestrator
    newTag: nightly

configMapGenerator:
  - name: madara-orchestrator-config
    behavior: merge
    literals:
      # Operational parameters - staging specific
      - RUST_LOG=info
      - MADARA_ORCHESTRATOR_OTEL_SERVICE_NAME=orchestrator-staging
      - MADARA_ORCHESTRATOR_MAX_CONCURRENT_PROVING_JOBS=15
      - MADARA_ORCHESTRATOR_MAX_CONCURRENT_SNOS_JOBS=1
      # Environment-specific configuration - MUST BE UPDATED
      - MADARA_ORCHESTRATOR_ATLANTIC_RPC_NODE_URL=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_ATLANTIC_VERIFIER_CONTRACT_ADDRESS=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_AWS_PREFIX=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_AWS_S3_BUCKET_IDENTIFIER=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_DATABASE_NAME=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_ETHEREUM_DA_RPC_URL=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_ETHEREUM_PRIVATE_KEY=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_ETHEREUM_SETTLEMENT_RPC_URL=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_EVENT_BRIDGE_TRIGGER_POLICY_NAME=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_EVENT_BRIDGE_TRIGGER_ROLE_NAME=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_L1_CORE_CONTRACT_ADDRESS=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_MADARA_RPC_URL=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_MAX_BLOCK_NO_TO_PROCESS=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_MIN_BLOCK_NO_TO_PROCESS=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_RPC_FOR_SNOS=CHANGEME-STAGING
      - MADARA_ORCHESTRATOR_STARKNET_OPERATOR_ADDRESS=CHANGEME-STAGING

secretGenerator:
  - name: madara-orchestrator-secrets
    behavior: merge
    literals:
      - AWS_ACCESS_KEY_ID=CHANGEME
      - AWS_SECRET_ACCESS_KEY=CHANGEME
      - MADARA_ORCHESTRATOR_ATLANTIC_API_KEY=CHANGEME
      - MADARA_ORCHESTRATOR_MONGODB_CONNECTION_URL=CHANGEME

patchesStrategicMerge:
  - deployment-patch.yaml

commonLabels:
  environment: staging
